function span1(e){return"<span class='"+e+"'>"}function spanx(e,t){return"."+e+" { font-family:"+fontFace+"; font-size:"+fontSize+"px; color:"+t+"; }\n"}function a1(e){return"<a class='"+e+"' href="}function ax(e,t){return"."+e+" { text-decoration:none; color:"+t+"; }\n"}function calOBJ(e,t,n,r){this.name=e;this.title=t;this.field=n;this.formName=r;this.form=null}function setFont(e,t){if(e!=""){fontFace=e}if(t>0){fontSize=t}}function setWidth(e,t,n,r){if(e>0){titleWidth=e}if(t==1||t==2){titleMode=t}if(n>0){dayWidth=n}if(r>0){dayDigits=r}}function setColor(e,t,n,r,i,s,o){if(e!=""){titleColor=e}if(t!=""){daysColor=t}if(n!=""){bodyColor=n}if(r!=""){dayColor=r}if(i!=""){currentDayColor=i}if(s!=""){footColor=s}if(o!=""){borderColor=o}}function setFontColor(e,t,n,r,i){if(e!=""){titleFontColor=e}if(t!=""){daysFontColor=t}if(n!=""){dayFontColor=n}if(r!=""){currentDayFontColor=r}if(i!=""){footFontColor=i}}function setFormat(e){calFormat=e}function setSize(e,t,n,r){if(e>0){calWidth=e}if(t>0){calHeight=t}calOffsetX=n;calOffsetY=r}function setWeekDay(e){if(e==0||e==1){weekDay=e}}function setMonthNames(e,t,n,r,i,s,o,u,a,f,l,c){if(e!=""){yxMonths[0]=e}if(t!=""){yxMonths[1]=t}if(n!=""){yxMonths[2]=n}if(r!=""){yxMonths[3]=r}if(i!=""){yxMonths[4]=i}if(s!=""){yxMonths[5]=s}if(o!=""){yxMonths[6]=o}if(u!=""){yxMonths[7]=u}if(a!=""){yxMonths[8]=a}if(f!=""){yxMonths[9]=f}if(l!=""){yxMonths[10]=l}if(c!=""){yxMonths[11]=c}}function setDayNames(e,t,n,r,i,s,o){if(e!=""){yxDays[0]=e;yxDays[7]=e}if(t!=""){yxDays[1]=t}if(n!=""){yxDays[2]=n}if(r!=""){yxDays[3]=r}if(i!=""){yxDays[4]=i}if(s!=""){yxDays[5]=s}if(o!=""){yxDays[6]=o}}function setLinkNames(e,t){if(e!=""){yxLinks[0]=e}if(t!=""){yxLinks[1]=t}}function addCalendar(e,t,n,r){cals[cals.length]=new calOBJ(e,t,n,r)}function findCalendar(e){for(var t=0;t<cals.length;t++){if(cals[t].name==e){if(cals[t].form==null){if(cals[t].formName==""){if(document.forms[0]){cals[t].form=document.forms[0]}}else if(document.forms[cals[t].formName]){cals[t].form=document.forms[cals[t].formName]}}return cals[t]}}return null}function getDayName(e,t,n){var r=new Date(e,t,n);return yxDays[r.getDay()].substring(0,3)}function getMonthFromName(e){for(var t=0;t<yxMonths.length;t++){if(yxMonths[t].toLowerCase().substring(0,3)==e.toLowerCase()){return t}}return 0}function getFormat(){var e=calFormat;e=e.replace(/\\/g,"\\\\");e=e.replace(/\//g,"\\/");e=e.replace(/\[/g,"\\[");e=e.replace(/\]/g,"\\]");e=e.replace(/\(/g,"\\(");e=e.replace(/\)/g,"\\)");e=e.replace(/\{/g,"\\{");e=e.replace(/\}/g,"\\}");e=e.replace(/\</g,"\\<");e=e.replace(/\>/g,"\\>");e=e.replace(/\|/g,"\\|");e=e.replace(/\*/g,"\\*");e=e.replace(/\?/g,"\\?");e=e.replace(/\+/g,"\\+");e=e.replace(/\^/g,"\\^");e=e.replace(/\$/g,"\\$");e=e.replace(/dd/i,"\\d\\d");e=e.replace(/mm/i,"\\d\\d");e=e.replace(/yyyy/i,"\\d\\d\\d\\d");e=e.replace(/day/i,"\\w\\w\\w");e=e.replace(/mon/i,"\\w\\w\\w");return new RegExp(e)}function getDateNumbers(e){var t,n,r;var i=calFormat.search(/yyyy/i);var s=calFormat.search(/mm/i);var o=calFormat.search(/mon/i);var u=calFormat.search(/dd/i);t=e.substring(i,i+4)-0;if(s!=-1){n=e.substring(s,s+2)-1}else{var n=getMonthFromName(e.substring(o,o+3))}r=e.substring(u,u+2)-0;return new Array(t,n,r)}function hideCal(){calWin.close();calWin=null;window.status=""}function getLeftIE(e,t){var n=0;if(e.tagName=="TD"){n=e.offsetLeft}else if(e.tagName=="TABLE"){n=e.offsetLeft;if(t){n+=e.cellPadding!=""?parseInt(e.cellPadding):2;t=false}}return n+(e.parentElement.tagName=="BODY"?0:getLeftIE(e.parentElement,t))}function getTopIE(e,t){var n=0;if(e.tagName=="TR"){n=e.offsetTop}else if(e.tagName=="TABLE"){n=e.offsetTop;if(t){n+=e.cellPadding!=""?parseInt(e.cellPadding):2;t=false}}return n+(e.parentElement.tagName=="BODY"?0:getTopIE(e.parentElement,t))}function getLeftN4(e){return e.pageX}function getTopN4(e){return e.pageY}function getLeftN6(e){return e.offsetLeft}function getTopN6(e){return e.offsetTop}function lastDay(e){var t=e.getFullYear(),n=e.getMonth();for(var r=31;r>=28;r--){var i=new Date(t,n,r);if(n==i.getMonth()){return r}}}function firstDay(e){var t=e.getFullYear(),n=e.getMonth();var r=new Date(t,n,1);return r.getDay()}function dayDisplay(e){if(dayDigits==0){return yxDays[e]}else{return yxDays[e].substring(0,dayDigits)}}function calTitle(e){var t=e.getFullYear(),n=yxMonths[e.getMonth()];var r;if(titleMode==2){r="<tr align='center' bgcolor='"+titleColor+"'>"+"<td colspan='7'>\n<table cellpadding='0' cellspacing='0' border='0'>"+"<tr align='center' valign='middle'>"+"<td align='right'>"+span1("title")+span2+"</td>"+"<td width='"+titleWidth+"'>"+"<b>"+span1("title")+t+span2+"</b></td><td align='left'>"+span1("title")+span2+"</td></tr><tr align='center' valign='middle'><td align='right'>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.prepMonth) window.opener.prepMonth("+e.getMonth()+")'> &#139; </a></b>"+span2+"</td><td width='"+titleWidth+"'><b>"+span1("title")+n+span2+"</b></td><td align='left'>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.nextMonth) window.opener.nextMonth("+e.getMonth()+")'> &#155; </a></b>"+span2+"</td></tr></table>\n</td></tr><tr align='center' bgcolor='"+daysColor+"'>"}else{r="<tr align='center' bgcolor='"+titleColor+"'>"+"<td colspan='7'>\n<table cellpadding='0' cellspacing='0' border='0'><tr align='center' valign='middle'><td>"+span1("title")+"<b> "+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.prepMonth) window.opener.prepMonth("+e.getMonth()+")'>&#139; </a></b>"+span2+"</td><td width='"+titleWidth+"'><nobr><b>"+span1("title")+n+" "+t+span2+"</b></nobr></td><td>"+span1("title")+"<b>"+a1("titlea")+"'javascript:if (window.opener && !window.opener.closed && window.opener.nextMonth) window.opener.nextMonth("+e.getMonth()+")'> &#155;</a> </b>"+span2+"</td></tr></table>\n</td></tr><tr align='center' bgcolor='"+daysColor+"'>"}for(var i=weekDay;i<weekDay+7;i++){r+="<td width='"+dayWidth+"'>"+span1("days")+dayDisplay(i)+span2+"</td>"}r+="</tr>";return r}function calHeader(){return"<head>\n<title>Calendrier       </title>\n<style type='text/css'>\n"+spanx("title",titleFontColor)+spanx("days",daysFontColor)+spanx("foot",footColor)+spanx("day",dayFontColor)+spanx("currentDay",currentDayFontColor)+ax("titlea",titleFontColor)+ax("daya",dayFontColor)+ax("currenta",currentDayFontColor)+ax("foota",footFontColor)+"</style>\n</head>\n<body>\n<table align='center' border='0' bgcolor='"+borderColor+"' cellspacing='0' cellpadding='1'><tr><td>\n<table cellspacing='1' cellpadding='3' border='0'>"}function calFooter(){var e="<tr bgcolor='"+footColor+"'><td colspan='7' align='center'>"+span1("foot")+"<b>"+a1("foota")+"'javascript:if (window.opener && !window.opener.closed && window.opener.hideCal) window.opener.hideCal()'>"+yxLinks[0]+"</a>"+span2+"</td></tr></table>\n</td></tr></table>\n</body>";return e}function calBody(e,t){var n="",r=1,i=firstDay(e),s=lastDay(e);if(weekDay>0&&i==0){i=7}for(var o=0;o<6;o++){n+="<tr align='center' bgcolor='"+bodyColor+"'>";for(var u=weekDay;u<weekDay+7;u++){if(o*7+u<i||r>s){n+="<td>"+span1("day")+" "+span2+"</td>"}else{var a=dayColor;var f="day";var l="daya";if(r==t){a=currentDayColor;f="currentDay";l="currenta"}n+="<td bgcolor='"+a+"' style='cursor:hand' onclick='javascript: if (window.opener && !window.opener.closed && window.opener.pickDate) window.opener.pickDate("+r+")'>"+span1(f)+r++ +span2+"</td>"}}n+="</tr>"}return n}function moveYear(e){cY+=e;var t=new Date(cY,cM,1);changeCal(t)}function prepMonth(e){cM=e-1;if(cM<0){cM=11;cY--}var t=new Date(cY,cM,1);changeCal(t)}function nextMonth(e){cM=e+1;if(cM>11){cM=0;cY++}var t=new Date(cY,cM,1);changeCal(t)}function changeCal(e){var t=0;if(currentCal!=null){var n=getFormat();if(currentCal.form[currentCal.field].value!=""&&n.test(currentCal.form[currentCal.field].value)){var r=getDateNumbers(currentCal.form[currentCal.field].value);if(r[0]==e.getFullYear()&&r[1]==e.getMonth()){t=r[2]}}else{var r=new Date;if(r.getFullYear()==e.getFullYear()&&r.getMonth()==e.getMonth()){t=r.getDate()}}}var i=calHeader()+calTitle(e)+calBody(e,t)+calFooter();calWin.document.open();calWin.document.write(i);calWin.document.close()}function markClick(e,t){winX=t.screenX;winY=t.screenY;if(winX+calWidth>screen.width){winX=screen.width-calWidth}if(winY+calHeight>screen.height-barHeight){winY=screen.height-barHeight-calHeight}return true}function showCal(e,t){var n=document.getElementById(e),r=n.form,n=t.target||t.srcElement,i="calendrier",s=currentCal;markClick(n,t);cals[0]=new calOBJ(i,"",e,r.name);var o=new Date,u=false;currentCal=findCalendar(i);if(currentCal!=null&&currentCal.form!=null&&currentCal.form[currentCal.field]){var a=getFormat(),f=currentCal.form[currentCal.field].value;if(f.length>0){f=f.substring(0,10)}if(f!=""&&a.test(f)){var l=getDateNumbers(f);o=new Date(l[0],l[1],l[2]);cY=l[0];cM=l[1];dd=l[2]}else{cY=o.getFullYear();cM=o.getMonth();dd=o.getDate()}var c=calHeader()+calTitle(o)+calBody(o,dd)+calFooter();if(calWin!=null&&!calWin.closed){u=true;calWin.moveTo(winX,winY)}if(!u){calWin=window.open("","cal","toolbar=0,width="+calWidth+",height="+calHeight+",top="+winX+",left="+winY)}calWin.document.open();calWin.document.write(c);calWin.document.close();calWin.focus()}else{if(currentCal==null){window.status="Calendar ["+i+"] not found."}else if(!currentCal.form){window.status="Form ["+currentCal.formName+"] not found."}else if(!currentCal.form[currentCal.field]){window.status="Form Field ["+currentCal.formName+"."+currentCal.field+"] not found."}if(s!=null){currentCal=s}}}function get2Digits(e){return(e<10?"0":"")+e}function clearDate(){currentCal.form[currentCal.field].value="";hideCal()}function pickDate(e){hideCal();window.focus();var t=calFormat;t=t.replace(/yyyy/i,cY);t=t.replace(/mm/i,get2Digits(cM+1));t=t.replace(/MON/,yxMonths[cM].substring(0,3).toUpperCase());t=t.replace(/Mon/i,yxMonths[cM].substring(0,3));t=t.replace(/dd/i,get2Digits(e));t=t.replace(/DAY/,getDayName(cY,cM,e).toUpperCase());t=t.replace(/day/i,getDayName(cY,cM,e));currentCal.form[currentCal.field].value=t;t=t.replace(/\//gi,"");currentCal.form[currentCal.field].valeurSaisie=t;currentCal.form[currentCal.field].focus();if(currentCal.form[currentCal.field].onchange!=null){currentCal.form[currentCal.field].onchange()}}function checkDate(e){var t=findCalendar(e);if(t!=null&&t.form!=null&&t.form[t.field]){var n=getFormat();if(n.test(t.form[t.field].value)){return 0}else{return 1}}else{return 2}}function getCurrentDate(){var e=calFormat,t=new Date;e=e.replace(/yyyy/i,t.getFullYear());e=e.replace(/mm/i,get2Digits(t.getMonth()+1));e=e.replace(/dd/i,get2Digits(t.getDate()));return e}function compareDates(e,t){var n=getFormat(),r,i;if(n.test(e)){r=getNumbers(e)}else{r=getNumbers(getCurrentDate())}if(n.test(t)){i=getNumbers(t)}else{i=getNumbers(getCurrentDate())}var s=r[0]+""+r[1]+""+r[2];var o=i[0]+""+i[1]+""+i[2];if(s==o){return 0}else if(s>o){return 1}else{return-1}}function getNumbers(e){var t=getFormat(),n,r,i;if(t.test(e)){var s=calFormat.search(/yyyy/i),o=calFormat.search(/mm/i),u=calFormat.search(/mon/i),a=calFormat.search(/dd/i);n=e.substring(s,s+4);if(o!=-1){r=e.substring(o,o+2)}else{var f=getMonthFromName(e.substring(u,u+3))+1;r=f<10?"0"+f:""+f}i=e.substring(a,a+2);return new Array(n,r,i)}else{return new Array("","","")}}var fontFace="verdana",fontSize=9,titleWidth=90,titleMode=1,dayWidth=12,dayDigits=1,titleColor="#cccccc",daysColor="#cccccc",bodyColor="#ffffff",dayColor="#ffffff",currentDayColor="#333333",footColor="#cccccc",borderColor="#333333",titleFontColor="#333333",daysFontColor="#333333",dayFontColor="#333333",currentDayFontColor="#ffffff",footFontColor="#333333",calFormat="yyyy/mm/dd",weekDay=0,barHeight=100,alWidth=200,calHeight=200,calOffsetX=-200,calOffsetY=16,calWin=null,winX=0,winY=0,cal="cal",cals=new Array,currentCal=null,yxMonths=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),yxDays=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"),yxLinks=new Array("[close]","[clear]"),isOpera6=navigator.appVersion.indexOf("MSIE 5")!=-1&&navigator.userAgent.indexOf("Opera 6")!=-1,isIE=navigator.userAgent.indexOf("MSIE")!=-1&&navigator.userAgent.substr(navigator.userAgent.indexOf("MSIE")+5,1)>=7,span2="</span>";setWidth(90,1,15,1);setColor("#E5E5F1","#F1F1FB","#FFFFFF","#FFFFFF","#000073","#E5E5F1","#333333");setFontColor("#000073","#000073","#000073","#FFFFFF","#000073");setFormat("dd/mm/yyyy");setSize(205,200,-200,16);setMonthNames("Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre");setDayNames("Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi");setLinkNames("[Fermer]","[Effacer]")